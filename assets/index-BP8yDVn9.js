import{_ as pe}from"./index-AmtRfZLy.js";import{aU as Q,o as f,b as c,w as t,d as l,av as me,aw as Y,s as n,e as y,ay as ee,az as le,aV as L,E as G,aB as te,a$ as X,aW as fe,W as V,n as ce,bS as A,b3 as j,t as W,a as S,x as K,ad as z,aI as Z,aX as ye,aZ as _e,af as ne,F as ae,aT as be,ah as ge,b7 as ve,b8 as Te,b9 as U,bd as Ve,bG as xe,bH as Ce,v as Me,bI as he,ae as ke,N as Ee,a8 as Ne}from"./index-B6yCc2m_.js";import{_ as oe}from"./index-BJMucfID.js";import{a as Fe}from"./index-C6QIYa0w.js";import{E as se,a as ie}from"./index-6AfRRrL-.js";/* empty css                     */import{_ as Ie}from"./index-HknBB0Jh.js";import{_ as Ue,u as $e,a as we,l as De,r as qe}from"./menu-select-CCyDj4F4.js";import{E as Re}from"./index-3i5fdD-M.js";import"./index-C-mkH4ob.js";import"./tree-CopuO4KQ.js";import"./tree-select-BVEOGY61.js";import"./index-CtEHLY2Q.js";const Se={__name:"menu-search",emits:["search"],setup(B,{emit:$}){const h=$,[_,I]=Q({menuName:"",status:void 0}),T=()=>{h("search",{..._})},x=()=>{I(),T()};return(k,m)=>{const e=ee,C=le,E=se,w=L,N=G,D=ie,q=te,i=oe;return f(),c(i,{"body-style":{paddingBottom:"2px"}},{default:t(()=>[l(q,{"label-width":"72px",onKeyup:me(T,["enter"]),onSubmit:m[2]||(m[2]=Y(()=>{},["prevent"]))},{default:t(()=>[l(D,{gutter:8},{default:t(()=>[l(E,{lg:6,md:8,sm:12,xs:24},{default:t(()=>[l(C,{label:"菜单名称"},{default:t(()=>[l(e,{clearable:"",modelValue:n(_).menuName,"onUpdate:modelValue":m[0]||(m[0]=o=>n(_).menuName=o),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),l(E,{lg:6,md:8,sm:12,xs:24},{default:t(()=>[l(C,{label:"状态"},{default:t(()=>[l(w,{code:"sys_normal_disable",modelValue:n(_).status,"onUpdate:modelValue":m[1]||(m[1]=o=>n(_).status=o),placeholder:"请选择"},null,8,["modelValue"])]),_:1})]),_:1}),l(E,{lg:12,md:8,sm:24,xs:24},{default:t(()=>[l(C,{"label-width":"16px"},{default:t(()=>[l(N,{type:"primary",onClick:T},{default:t(()=>m[3]||(m[3]=[y("查询")])),_:1}),l(N,{onClick:x},{default:t(()=>m[4]||(m[4]=[y("重置")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},ze={__name:"menu-edit",props:X({data:Object,parentId:Number},{modelValue:{type:Boolean},modelModifiers:{}}),emits:X(["done"],["update:modelValue"]),setup(B,{expose:$,emit:h}){const _=B,I=h,T=fe(B,"modelValue"),x=V(!1),k=V(!1),m=V(null),[e,C,E]=Q({menuId:void 0,parentId:void 0,menuName:"",menuType:"M",openType:0,icon:"",path:"",component:"",query:"",status:"0",perms:"",orderNum:void 0,visible:"0",isCache:"0"}),w=ce(()=>{const s={menuName:[{required:!0,type:"string",message:"请输入菜单名称",trigger:"blur"}],orderNum:[{required:!0,type:"number",message:"请输入排序号",trigger:"blur"}],query:[{type:"string",validator:(a,u,d)=>{if(u){const v="请输入正确的参数格式";try{const b=JSON.parse(u);if(b==null||typeof b!="object")return d(v)}catch(b){return d(v)}}d()},trigger:"blur"}]};return e.menuType!=="F"&&(s.path=[{required:!0,type:"string",message:e.openType===2?"请输入外链地址":"请输入路由地址",trigger:"blur"},{type:"string",validator:(a,u,d)=>{if(u){if(e.openType===2){if(!A(u)){d("请输入正确的链接地址");return}}else if(u==="/"){d("路由地址不能为 /");return}}d()},trigger:"blur"}],e.menuType==="C"&&e.openType!==2&&(s.component=[{required:!0,type:"string",message:e.openType===1?"请输入内嵌地址":"请输入组件路径",trigger:"blur"},{type:"string",validator:(a,u,d)=>{if(u&&e.openType===1&&!A(u)){d("请输入正确的链接地址");return}d()},trigger:"blur"}])),s}),N=()=>{T.value=!1},D=()=>{var s,a;(a=(s=m.value)==null?void 0:s.validate)==null||a.call(s,u=>{if(!u)return;k.value=!0,(x.value?$e:we)({...e,isFrame:e.openType==2?"0":"1"}).then(v=>{k.value=!1,z.success(v),N(),I("done")}).catch(v=>{k.value=!1,z.error(v.message)})})},q=()=>{var s,a;e.menuType=="M"?(e.perms="",e.openType=0,e.component="",e.isCache="0",e.query=""):e.menuType=="F"&&(e.openType=0,e.icon="",e.path="",e.component="",e.visible="0",e.isCache="0",e.query=""),(a=(s=m.value)==null?void 0:s.clearValidate)==null||a.call(s)},i=()=>{var s,a;e.openType===2?(e.component="",e.perms="",e.isCache="0",e.query=""):e.openType===1&&(e.query=""),(a=(s=m.value)==null?void 0:s.clearValidate)==null||a.call(s)},o=()=>{if(_.data){const s=_.data.isFrame=="0",a=A(_.data.component);E({..._.data,menuType:s?"C":_.data.menuType,openType:s?2:a?1:0}),x.value=!0}else C(),e.parentId=_.parentId,x.value=!1;Z(()=>{Z(()=>{var s,a;(a=(s=m.value)==null?void 0:s.clearValidate)==null||a.call(s)})})},g=V(null);return $({reloadMenuSelectData:()=>{var s,a;(a=(s=g.value)==null?void 0:s.reload)==null||a.call(s)}}),(s,a)=>{const u=le,d=ee,v=se,b=ye,R=_e,M=ie,p=ne,F=ae,O=be,J=L,ue=Re,re=te,P=G,de=ge;return f(),c(de,{form:"",width:740,modelValue:T.value,"onUpdate:modelValue":a[14]||(a[14]=r=>T.value=r),title:x.value?"修改菜单":"新建菜单",onOpen:o},{footer:t(()=>[l(P,{onClick:N},{default:t(()=>a[17]||(a[17]=[y("取消")])),_:1}),l(P,{type:"primary",loading:k.value,onClick:D},{default:t(()=>a[18]||(a[18]=[y(" 保存 ")])),_:1},8,["loading"])]),default:t(()=>[l(re,{ref_key:"formRef",ref:m,model:n(e),rules:w.value,"label-width":"100px","validate-on-rule-change":!1,onSubmit:a[13]||(a[13]=Y(()=>{},["prevent"]))},{default:t(()=>[l(M,{gutter:16},{default:t(()=>[l(v,{sm:12,xs:24},{default:t(()=>[l(u,{label:"上级菜单",prop:"parentId"},{default:t(()=>[l(Ue,{ref_key:"menuSelectRef",ref:g,modelValue:n(e).parentId,"onUpdate:modelValue":a[0]||(a[0]=r=>n(e).parentId=r)},null,8,["modelValue"])]),_:1}),l(u,{label:"菜单名称",prop:"menuName"},{default:t(()=>[l(d,{clearable:"",modelValue:n(e).menuName,"onUpdate:modelValue":a[1]||(a[1]=r=>n(e).menuName=r),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1})]),_:1}),l(v,{sm:12,xs:24},{default:t(()=>[l(u,{label:"菜单类型",prop:"menuType"},{default:t(()=>[l(R,{modelValue:n(e).menuType,"onUpdate:modelValue":a[2]||(a[2]=r=>n(e).menuType=r),onChange:q},{default:t(()=>[l(b,{value:"M",label:"目录"}),l(b,{value:"C",label:"菜单"}),l(b,{value:"F",label:"按钮"})]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"打开方式"},{default:t(()=>[l(R,{modelValue:n(e).openType,"onUpdate:modelValue":a[3]||(a[3]=r=>n(e).openType=r),disabled:n(e).menuType=="M"||n(e).menuType=="F",onChange:i},{default:t(()=>[l(b,{value:0,label:"组件"}),l(b,{value:1,label:"内嵌"}),l(b,{value:2,label:"外链"})]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1}),l(p,{style:{margin:"8px 0 22px 0",opacity:"0.6"}}),l(M,{gutter:16},{default:t(()=>[l(v,{sm:12,xs:24},{default:t(()=>[l(u,{label:"菜单图标",prop:"icon"},{default:t(()=>[l(Ie,{clearable:"",filterable:"popper","popper-width":460,"popper-height":388,"popper-options":{strategy:"fixed"},placeholder:"请选择图标",modelValue:n(e).icon,"onUpdate:modelValue":a[4]||(a[4]=r=>n(e).icon=r),disabled:n(e).menuType=="F"},null,8,["modelValue","disabled"])]),_:1}),l(u,{prop:"path"},{label:t(()=>[n(e).openType===2?(f(),c(O,{key:0,content:"需要以`http://`、`https://`、`//`开头",placement:"top-start","popper-options":{modifiers:[{name:"offset",options:{offset:[-12,10]}}]}},{default:t(()=>[l(F,{size:15,style:{"align-self":"center","margin-right":"4px",cursor:"help"}},{default:t(()=>[l(n(j),{style:{opacity:"0.6"}})]),_:1})]),_:1})):W("",!0),S("span",null,K(n(e).openType===2?"外链地址":"路由地址"),1)]),default:t(()=>[l(d,{clearable:"",modelValue:n(e).path,"onUpdate:modelValue":a[5]||(a[5]=r=>n(e).path=r),disabled:n(e).menuType=="F",placeholder:n(e).openType===2?"请输入外链地址":"请输入路由地址"},null,8,["modelValue","disabled","placeholder"])]),_:1}),l(u,{prop:"component"},{label:t(()=>[n(e).openType===1?(f(),c(O,{key:0,content:"需要以`http://`、`https://`、`//`开头",placement:"top-start","popper-options":{modifiers:[{name:"offset",options:{offset:[-12,10]}}]}},{default:t(()=>[l(F,{size:15,style:{"align-self":"center","margin-right":"4px",cursor:"help"}},{default:t(()=>[l(n(j),{style:{opacity:"0.6"}})]),_:1})]),_:1})):W("",!0),S("span",null,K(n(e).openType===1?"内嵌地址":"组件路径"),1)]),default:t(()=>[l(d,{clearable:"",modelValue:n(e).component,"onUpdate:modelValue":a[6]||(a[6]=r=>n(e).component=r),disabled:n(e).menuType=="M"||n(e).menuType=="F"||n(e).openType===2,placeholder:n(e).openType===1?"请输入内嵌地址":"请输入组件路径"},null,8,["modelValue","disabled","placeholder"])]),_:1}),l(u,{label:"路由参数",prop:"query"},{label:t(()=>[l(O,{placement:"top-start","popper-options":{modifiers:[{name:"offset",options:{offset:[-12,10]}}]}},{content:t(()=>a[15]||(a[15]=[y(' 访问路由的默认传递参数, 如: {"id": 1, "name": "ry"} ')])),default:t(()=>[l(F,{size:15,style:{"align-self":"center","margin-right":"4px",cursor:"help"}},{default:t(()=>[l(n(j),{style:{opacity:"0.6"}})]),_:1})]),_:1}),a[16]||(a[16]=S("span",null,"路由参数",-1))]),default:t(()=>[l(d,{clearable:"",modelValue:n(e).query,"onUpdate:modelValue":a[7]||(a[7]=r=>n(e).query=r),maxlength:255,disabled:n(e).menuType=="M"||n(e).menuType=="F"||n(e).openType===2||n(e).openType===1,placeholder:"请输入路由参数"},null,8,["modelValue","disabled"])]),_:1}),l(u,{label:"菜单状态",prop:"status"},{default:t(()=>[l(J,{code:"sys_normal_disable",type:"radio",modelValue:n(e).status,"onUpdate:modelValue":a[8]||(a[8]=r=>n(e).status=r)},null,8,["modelValue"])]),_:1})]),_:1}),l(v,{sm:12,xs:24},{default:t(()=>[l(u,{label:"权限字符",prop:"perms"},{default:t(()=>[l(d,{clearable:"",modelValue:n(e).perms,"onUpdate:modelValue":a[9]||(a[9]=r=>n(e).perms=r),placeholder:"请输入权限字符",maxlength:100,disabled:n(e).menuType=="M"||n(e).menuType=="C"&&n(e).openType===2},null,8,["modelValue","disabled"])]),_:1}),l(u,{label:"显示排序",prop:"orderNum"},{default:t(()=>[l(ue,{min:0,max:99999,modelValue:n(e).orderNum,"onUpdate:modelValue":a[10]||(a[10]=r=>n(e).orderNum=r),placeholder:"请输入显示排序","controls-position":"right",class:"ele-fluid"},null,8,["modelValue"])]),_:1}),l(u,{label:"显示状态"},{default:t(()=>[l(J,{code:"sys_show_hide",type:"radio",modelValue:n(e).visible,"onUpdate:modelValue":a[11]||(a[11]=r=>n(e).visible=r),disabled:n(e).menuType=="F"},null,8,["modelValue","disabled"]),l(O,{content:"选择不展示只注册路由不展示在侧边栏, 比如添加页面应该选择不展示","popper-style":{maxWidth:"240px"}},{default:t(()=>[l(F,{size:15,style:{"margin-left":"16px",cursor:"help"}},{default:t(()=>[l(n(j),{style:{opacity:"0.6"}})]),_:1})]),_:1})]),_:1}),l(u,{label:"是否缓存",prop:"isCache"},{default:t(()=>[l(R,{modelValue:n(e).isCache,"onUpdate:modelValue":a[12]||(a[12]=r=>n(e).isCache=r),disabled:n(e).menuType=="M"||n(e).menuType=="F"||n(e).openType===2},{default:t(()=>[l(b,{value:"0",label:"缓存"}),l(b,{value:"1",label:"不缓存"})]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}},Be={style:{display:"inline-flex","align-items":"center"}},Ye=Object.assign({name:"SystemMenu"},{__name:"index",setup(B){const[$]=ve(["sys_show_hide"]),h=V(null),_=V([{type:"index",columnKey:"index",width:50,align:"center",fixed:"left"},{prop:"menuName",label:"菜单名称",slot:"menuName",minWidth:160},{prop:"path",label:"路由地址",minWidth:110},{prop:"orderNum",label:"排序",align:"center",width:100},{prop:"visible",label:"状态",align:"center",slot:"visible",width:100,formatter:i=>{var o;return(o=$.value.find(g=>g.dictValue==i.visible))==null?void 0:o.dictLabel}},{prop:"menuType",label:"类型",align:"center",slot:"menuType",width:100,formatter:i=>({M:"目录",C:"菜单",F:"按钮"})[i.menuType]},{columnKey:"action",label:"操作",width:180,align:"center",slot:"action",hideInPrint:!0,hideInExport:!0}]),I=V(null),T=V(!1),x=V(),k=V(null),m=async({where:i})=>{const o=await De({...i});return he({data:o,idField:"menuId",parentIdField:"parentId"})},e=i=>{var o,g;(g=(o=h.value)==null?void 0:o.reload)==null||g.call(o,{where:i})},C=(i,o)=>{I.value=i!=null?i:null,x.value=o,T.value=!0},E=()=>{var i,o;(o=(i=k.value)==null?void 0:i.reloadMenuSelectData)==null||o.call(i)},w=i=>{ke.confirm(`是否确认删除名称为“${i.menuName}”的数据项？`,"系统提示",{type:"warning",draggable:!0}).then(()=>{const o=z.loading({message:"请求中..",plain:!0});qe(i.menuId).then(()=>{o.close(),z.success("删除成功"),e(),E()}).catch(g=>{o.close(),z.error(g.message)})}).catch(()=>{})},N=()=>{var i,o;(o=(i=h.value)==null?void 0:i.toggleRowExpansionAll)==null||o.call(i,!0)},D=()=>{var i,o;(o=(i=h.value)==null?void 0:i.toggleRowExpansionAll)==null||o.call(i,!1)},q=()=>{e(),E()};return(i,o)=>{const g=G,H=ae,s=Ee,a=L,u=Ne,d=ne,v=Fe,b=oe,R=pe,M=Te("permission");return f(),c(R,null,{default:t(()=>[l(Se,{onSearch:e}),l(b,{"body-style":{paddingTop:"8px"}},{default:t(()=>[l(v,{sticky:"",ref_key:"tableRef",ref:h,"row-key":"menuId",columns:_.value,datasource:m,"show-overflow-tooltip":!0,"highlight-current-row":"","export-config":{fileName:"菜单数据"},"default-expand-all":!1,pagination:!1,"cache-key":"systemMenuTable"},{toolbar:t(()=>[U((f(),c(g,{type:"primary",class:"ele-btn-icon",icon:n(Ve),onClick:o[0]||(o[0]=p=>C())},{default:t(()=>o[2]||(o[2]=[y(" 新建 ")])),_:1},8,["icon"])),[[M,"system:menu:add"]]),l(g,{class:"ele-btn-icon",icon:n(xe),onClick:N},{default:t(()=>o[3]||(o[3]=[y(" 展开全部 ")])),_:1},8,["icon"]),l(g,{class:"ele-btn-icon",icon:n(Ce),onClick:D},{default:t(()=>o[4]||(o[4]=[y(" 折叠全部 ")])),_:1},8,["icon"])]),menuName:t(({row:p})=>[p.icon&&p.icon!="#"?(f(),c(H,{key:0,size:16,style:{"margin-right":"8px","vertical-align":"-2px"}},{default:t(()=>[(f(),c(Me(p.icon)))]),_:2},1024)):W("",!0),S("span",null,K(p.menuName),1)]),menuType:t(({row:p})=>[p.isFrame=="0"?(f(),c(s,{key:0,size:"small",type:"danger","disable-transitions":!0},{default:t(()=>o[5]||(o[5]=[y(" 外链 ")])),_:1})):p.menuType==="M"?(f(),c(s,{key:1,size:"small","disable-transitions":!0},{default:t(()=>o[6]||(o[6]=[y(" 目录 ")])),_:1})):p.menuType==="C"?(f(),c(s,{key:2,size:"small",type:"success","disable-transitions":!0},{default:t(()=>o[7]||(o[7]=[y(" 菜单 ")])),_:1})):p.menuType==="F"?(f(),c(s,{key:3,size:"small",type:"info","disable-transitions":!0},{default:t(()=>o[8]||(o[8]=[y(" 按钮 ")])),_:1})):W("",!0)]),visible:t(({row:p})=>[l(a,{code:"sys_show_hide",type:"tag","model-value":p.visible},null,8,["model-value"])]),action:t(({row:p})=>[S("div",Be,[U((f(),c(u,{type:"primary",underline:!1,onClick:F=>C(null,p.menuId)},{default:t(()=>o[9]||(o[9]=[y(" 添加 ")])),_:2},1032,["onClick"])),[[M,"system:menu:add"]]),U(l(d,{direction:"vertical",style:{margin:"0 8px"}},null,512),[[M,"system:menu:edit"]]),U((f(),c(u,{type:"primary",underline:!1,onClick:F=>C(p)},{default:t(()=>o[10]||(o[10]=[y(" 修改 ")])),_:2},1032,["onClick"])),[[M,"system:menu:edit"]]),U(l(d,{direction:"vertical",style:{margin:"0 8px"}},null,512),[[M,"system:menu:remove"]]),U((f(),c(u,{type:"danger",underline:!1,onClick:F=>w(p)},{default:t(()=>o[11]||(o[11]=[y(" 删除 ")])),_:2},1032,["onClick"])),[[M,"system:menu:remove"]])])]),_:1},8,["columns"])]),_:1}),l(ze,{ref_key:"menuEditRef",ref:k,modelValue:T.value,"onUpdate:modelValue":o[1]||(o[1]=p=>T.value=p),data:I.value,"parent-id":x.value,onDone:q},null,8,["modelValue","data","parent-id"])]),_:1})}}});export{Ye as default};
