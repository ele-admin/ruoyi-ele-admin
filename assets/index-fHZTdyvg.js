import{_ as U}from"./index-AmtRfZLy.js";import{_ as j,W as s,ai as E,o as F,b as P,w as a,d as t,s as u,aR as G,a as m,a4 as H,aw as z,e as R,R as J,a2 as V,aS as Q,x as k,ae as C,ad as o,F as X,f as Y,aT as Z,a8 as ee}from"./index-B6yCc2m_.js";import{E as ae,_ as te,a as le}from"./index-6AfRRrL-.js";/* empty css                          */import{_ as ne}from"./index-BJMucfID.js";import{a as oe}from"./index-C6QIYa0w.js";import{a as se,c as ce,b as re,d as ie,e as ue,f as me}from"./index-DjWEZFcM.js";import{E as de,a as pe}from"./index-BQVafdAu.js";const _e={style:{"word-break":"break-all"}},fe={style:{"word-break":"break-all"}},ge=Object.assign({name:"MonitorCacheList"},{__name:"index",setup(he){const g=s(null),B=s([{type:"index",columnKey:"index",width:50,align:"center"},{prop:"cacheName",label:"缓存名称",align:"center",minWidth:80,formatter:n=>n.cacheName.replace(":","")},{prop:"remark",label:"备注",align:"center",minWidth:80},{columnKey:"action",label:"操作",width:80,align:"center",slot:"action"}]),M=s([{type:"index",columnKey:"index",width:50,align:"center"},{prop:"cacheKey",label:"缓存键名",align:"center",minWidth:80,formatter:n=>n.cacheKey.replace(n.cacheName,"")},{columnKey:"action",label:"操作",width:80,align:"center",slot:"action"}]),c=s(null),d=s(null),W=()=>se(),h=s([]),_=s(!1),p=s({}),f=s(!1),D=n=>{C.confirm("是否确认清空“"+n.cacheName+"”？","系统提示",{type:"warning",draggable:!0}).then(()=>{const e=o.loading({message:"请求中..",plain:!0});ce(n.cacheName).then(()=>{var l,i;e.close(),o.success("清空成功"),(i=(l=g.value)==null?void 0:l.reload)==null||i.call(l)}).catch(l=>{e.close(),o.error(l.message)})}).catch(()=>{})},I=n=>{C.confirm("是否确认删除“"+n.cacheKey+"”？","系统提示",{type:"warning",draggable:!0}).then(()=>{const e=o.loading({message:"请求中..",plain:!0});re(n.cacheKey).then(()=>{e.close(),o.success("删除成功"),y()}).catch(l=>{e.close(),o.error(l.message)})}).catch(()=>{})},L=()=>{C.confirm("是否确认清空全部缓存？","系统提示",{type:"warning",draggable:!0}).then(()=>{const n=o.loading({message:"请求中..",plain:!0});ie().then(()=>{var e,l;n.close(),o.success("清空成功"),(l=(e=g.value)==null?void 0:e.reload)==null||l.call(e)}).catch(e=>{n.close(),o.error(e.message)})}).catch(()=>{})},y=()=>{var n;if(!c.value){h.value=[];return}_.value=!0,ue((n=c.value)==null?void 0:n.cacheName).then(e=>{_.value=!1,h.value=e.map(l=>({cacheKey:l,cacheName:c.value.cacheName}))}).catch(e=>{_.value=!1,o.error(e.message)})},N=()=>{var n,e;c.value&&d.value?(f.value=!0,me((n=c.value)==null?void 0:n.cacheName,(e=d.value)==null?void 0:e.cacheKey).then(l=>{f.value=!1,p.value=l}).catch(l=>{f.value=!1,o.error(l.message)})):p.value={}};return E(c,()=>{y()}),E(d,()=>{N()}),(n,e)=>{const l=X,i=Y,v=Z,K=ee,$=oe,b=ne,x=ae,w=de,S=pe,q=te,A=le,O=U;return F(),P(O,{"flex-table":"","hide-footer":"","multi-card":!1,style:{"min-height":"246px"}},{default:a(()=>[t(A,{gutter:16,style:{height:"100%"}},{default:a(()=>[t(x,{md:8,sm:24,xs:24,style:{height:"100%"}},{default:a(()=>[t(b,{"flex-table":"",style:{height:"100%"}},{header:a(()=>[t(l,{size:16,style:{"vertical-align":"-2px","margin-right":"8px"}},{default:a(()=>[t(u(G))]),_:1}),e[2]||(e[2]=m("span",null,"缓存列表",-1))]),extra:a(()=>[t(v,{content:"清空",placement:"top",offset:4},{default:a(()=>[t(i,{type:"danger",icon:u(H),"icon-props":{size:16},style:{cursor:"pointer"},onClick:L},null,8,["icon"])]),_:1})]),default:a(()=>[t($,{ref_key:"tableRef",ref:g,"row-key":"cacheName",columns:B.value,datasource:W,"show-overflow-tooltip":!0,current:c.value,"onUpdate:current":e[0]||(e[0]=r=>c.value=r),"highlight-current-row":"","row-style":{cursor:"pointer"},pagination:!1,toolbar:!1,"bottom-line":!1},{action:a(({row:r})=>[t(K,{type:"danger",underline:!1,onClick:z(T=>D(r),["stop"])},{default:a(()=>e[3]||(e[3]=[R(" 清空 ")])),_:2},1032,["onClick"])]),_:1},8,["columns","current"])]),_:1})]),_:1}),t(x,{md:8,sm:24,xs:24,style:{height:"100%"}},{default:a(()=>[t(b,{"flex-table":"",style:{height:"100%"}},{header:a(()=>[t(l,{size:16,style:{"vertical-align":"-2px","margin-right":"8px"}},{default:a(()=>[t(u(J))]),_:1}),e[4]||(e[4]=m("span",null,"键名列表",-1))]),extra:a(()=>[t(v,{content:"刷新",placement:"top",offset:4},{default:a(()=>[t(i,{type:"primary",icon:u(V),"icon-props":{size:16},style:{cursor:"pointer"},onClick:y},null,8,["icon"])]),_:1})]),default:a(()=>[t($,{"row-key":"cacheKey",columns:M.value,datasource:h.value,"show-overflow-tooltip":!0,loading:_.value,"load-on-created":!1,current:d.value,"onUpdate:current":e[1]||(e[1]=r=>d.value=r),"highlight-current-row":"","row-style":{cursor:"pointer"},pagination:{layout:"total, prev, pager, next",hideOnSinglePage:!0},toolbar:!1,"bottom-line":!1},{action:a(({row:r})=>[t(K,{type:"danger",underline:!1,onClick:z(T=>I(r),["stop"])},{default:a(()=>e[5]||(e[5]=[R(" 删除 ")])),_:2},1032,["onClick"])]),_:1},8,["columns","datasource","loading","current"])]),_:1})]),_:1}),t(x,{md:8,sm:24,xs:24,style:{height:"100%"}},{default:a(()=>[t(b,{"flex-table":"",style:{height:"100%"}},{header:a(()=>[t(l,{size:16,style:{"vertical-align":"-2px","margin-right":"8px"}},{default:a(()=>[t(u(Q))]),_:1}),e[6]||(e[6]=m("span",null,"缓存内容",-1))]),extra:a(()=>[t(v,{content:"刷新",placement:"top",offset:4},{default:a(()=>[t(i,{type:"primary",icon:u(V),"icon-props":{size:16},style:{cursor:"pointer"},onClick:N},null,8,["icon"])]),_:1})]),default:a(()=>[t(q,{loading:f.value},{default:a(()=>[t(S,{border:!0,column:1,class:"detail-table"},{default:a(()=>[t(w,{label:"缓存名称"},{default:a(()=>[m("div",null,k(p.value.cacheName),1)]),_:1}),t(w,{label:"缓存键名"},{default:a(()=>[m("div",_e,k(p.value.cacheKey),1)]),_:1}),t(w,{label:"缓存内容"},{default:a(()=>[m("div",fe,k(p.value.cacheValue),1)]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})}}}),Ke=j(ge,[["__scopeId","data-v-92147c66"]]);export{Ke as default};
