import{_ as L}from"./index-AmtRfZLy.js";import{aU as A,o as x,b as N,w as l,d as a,av as G,aw as W,s as d,e as m,ay as K,az as S,aV as R,E as z,aB as q,a$ as O,aW as H,W as g,aq as P,ad as U,aI as T,ah as J,b7 as Q,b8 as X,b9 as C,bd as Y,bG as Z,bH as ee,a as te,c as ae,$ as le,t as oe,bI as ne,ae as se,a8 as de,af as re}from"./index-B6yCc2m_.js";import{_ as j}from"./index-BJMucfID.js";import{a as ie}from"./index-C6QIYa0w.js";import{E as ue,a as me}from"./index-6AfRRrL-.js";/* empty css                     */import{p as pe,e as ce,_ as _e,u as fe,a as ge,l as be,r as ve}from"./dept-select-D-dWypkS.js";import{E as ye}from"./index-3i5fdD-M.js";import"./tree-CopuO4KQ.js";import"./tree-select-BVEOGY61.js";import"./index-CtEHLY2Q.js";const Ve={__name:"dept-search",emits:["search"],setup(D,{emit:w}){const u=w,[p,b]=A({deptName:"",status:void 0}),i=()=>{u("search",{...p})},c=()=>{b(),i()};return(v,o)=>{const I=K,_=S,k=ue,E=R,$=z,n=me,e=q,t=j;return x(),N(t,{"body-style":{paddingBottom:"2px"}},{default:l(()=>[a(e,{"label-width":"72px",onKeyup:G(i,["enter"]),onSubmit:o[2]||(o[2]=W(()=>{},["prevent"]))},{default:l(()=>[a(n,{gutter:8},{default:l(()=>[a(k,{lg:6,md:8,sm:12,xs:24},{default:l(()=>[a(_,{label:"部门名称"},{default:l(()=>[a(I,{clearable:"",modelValue:d(p).deptName,"onUpdate:modelValue":o[0]||(o[0]=r=>d(p).deptName=r),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),a(k,{lg:6,md:8,sm:12,xs:24},{default:l(()=>[a(_,{label:"状态"},{default:l(()=>[a(E,{code:"sys_normal_disable",modelValue:d(p).status,"onUpdate:modelValue":o[1]||(o[1]=r=>d(p).status=r),placeholder:"请选择"},null,8,["modelValue"])]),_:1})]),_:1}),a(k,{lg:12,md:8,sm:24,xs:24},{default:l(()=>[a(_,{"label-width":"16px"},{default:l(()=>[a($,{type:"primary",onClick:i},{default:l(()=>o[3]||(o[3]=[m("查询")])),_:1}),a($,{onClick:c},{default:l(()=>o[4]||(o[4]=[m("重置")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},xe={__name:"dept-edit",props:O({data:Object,parentId:Number,organizationData:Array},{modelValue:{type:Boolean},modelModifiers:{}}),emits:O(["done"],["update:modelValue"]),setup(D,{emit:w}){const u=D,p=w,b=H(D,"modelValue"),i=g(!1),c=g(!1),v=g(null),[o,I,_]=A({deptId:void 0,parentId:void 0,deptName:"",orderNum:0,leader:"",phone:"",email:"",status:"0"}),k=P({deptName:[{required:!0,message:"请输入部门名称",type:"string",trigger:"blur"}],orderNum:[{required:!0,message:"请输入显示排序",type:"number",trigger:"blur"}],phone:[{pattern:pe,message:"手机号格式不正确",type:"string",trigger:"blur"}],email:[{pattern:ce,message:"邮箱格式不正确",type:"string",trigger:"blur"}]}),E=()=>{b.value=!1},$=()=>{var e,t;(t=(e=v.value)==null?void 0:e.validate)==null||t.call(e,r=>{if(!r)return;c.value=!0,(i.value?fe:ge)({...o,parentId:o.parentId||0}).then(y=>{c.value=!1,U.success(y),E(),p("done")}).catch(y=>{c.value=!1,U.error(y.message)})})},n=()=>{u.data?(_({...u.data,parentId:u.data.parentId||void 0}),i.value=!0):(I(),o.parentId=u.parentId,i.value=!1),T(()=>{T(()=>{var e,t;(t=(e=v.value)==null?void 0:e.clearValidate)==null||t.call(e)})})};return(e,t)=>{const r=S,f=K,y=ye,B=R,F=q,h=z,V=J;return x(),N(V,{form:"",width:460,modelValue:b.value,"onUpdate:modelValue":t[8]||(t[8]=s=>b.value=s),title:i.value?"修改部门":"添加部门",onOpen:n},{footer:l(()=>[a(h,{onClick:E},{default:l(()=>t[9]||(t[9]=[m("取消")])),_:1}),a(h,{type:"primary",loading:c.value,onClick:$},{default:l(()=>t[10]||(t[10]=[m(" 保存 ")])),_:1},8,["loading"])]),default:l(()=>[a(F,{ref_key:"formRef",ref:v,model:d(o),rules:k,"label-width":"80px",onSubmit:t[7]||(t[7]=W(()=>{},["prevent"]))},{default:l(()=>[a(r,{label:"上级部门",prop:"parentId"},{default:l(()=>[a(_e,{modelValue:d(o).parentId,"onUpdate:modelValue":t[0]||(t[0]=s=>d(o).parentId=s),placeholder:"请选择上级部门","organization-data":D.organizationData},null,8,["modelValue","organization-data"])]),_:1}),a(r,{label:"部门名称",prop:"deptName"},{default:l(()=>[a(f,{clearable:"",modelValue:d(o).deptName,"onUpdate:modelValue":t[1]||(t[1]=s=>d(o).deptName=s),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1}),a(r,{label:"显示排序",prop:"orderNum"},{default:l(()=>[a(y,{min:0,max:99999,modelValue:d(o).orderNum,"onUpdate:modelValue":t[2]||(t[2]=s=>d(o).orderNum=s),placeholder:"请输入显示排序","controls-position":"right",class:"ele-fluid"},null,8,["modelValue"])]),_:1}),a(r,{label:"负责人",prop:"leader"},{default:l(()=>[a(f,{clearable:"",maxlength:20,modelValue:d(o).leader,"onUpdate:modelValue":t[3]||(t[3]=s=>d(o).leader=s),placeholder:"请输入负责人"},null,8,["modelValue"])]),_:1}),a(r,{label:"联系电话",prop:"phone"},{default:l(()=>[a(f,{clearable:"",modelValue:d(o).phone,"onUpdate:modelValue":t[4]||(t[4]=s=>d(o).phone=s),placeholder:"请输入联系电话",maxlength:11},null,8,["modelValue"])]),_:1}),a(r,{label:"邮箱",prop:"email"},{default:l(()=>[a(f,{clearable:"",modelValue:d(o).email,"onUpdate:modelValue":t[5]||(t[5]=s=>d(o).email=s),placeholder:"请输入邮箱",maxlength:50},null,8,["modelValue"])]),_:1}),a(r,{label:"部门状态",prop:"status"},{default:l(()=>[a(B,{code:"sys_normal_disable",type:"radio",modelValue:d(o).status,"onUpdate:modelValue":t[6]||(t[6]=s=>d(o).status=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}},Ie={style:{display:"inline-flex","align-items":"center"}},Re=Object.assign({name:"SystemDept"},{__name:"index",setup(D){const[w]=Q(["sys_normal_disable"]),u=g(null),p=g([{type:"index",columnKey:"index",width:50,align:"center",fixed:"left"},{prop:"deptName",label:"部门名称",minWidth:160},{prop:"orderNum",label:"排序",align:"center",minWidth:90},{prop:"status",label:"状态",align:"center",slot:"status",minWidth:90,formatter:n=>{var e;return(e=w.value.find(t=>t.dictValue==n.status))==null?void 0:e.dictLabel}},{prop:"createTime",label:"创建时间",align:"center",width:180},{columnKey:"action",label:"操作",width:180,align:"center",slot:"action",hideInPrint:!0,hideInExport:!0}]),b=g(null),i=g(!1),c=g(),v=g([]),o=async({where:n})=>{const e=await be({...n});return v.value=ne({data:e,idField:"deptId",parentIdField:"parentId"}),v.value},I=n=>{var e,t;(t=(e=u.value)==null?void 0:e.reload)==null||t.call(e,{where:n})},_=(n,e)=>{b.value=n!=null?n:null,c.value=e,i.value=!0},k=n=>{se.confirm(`是否确认删除名称为“${n.deptName}”的数据项？`,"系统提示",{type:"warning",draggable:!0}).then(()=>{const e=U.loading({message:"请求中..",plain:!0});ve(n.deptId).then(()=>{e.close(),U.success("删除成功"),I()}).catch(t=>{e.close(),U.error(t.message)})}).catch(()=>{})},E=()=>{var n,e;(e=(n=u.value)==null?void 0:n.toggleRowExpansionAll)==null||e.call(n,!0)},$=()=>{var n,e;(e=(n=u.value)==null?void 0:n.toggleRowExpansionAll)==null||e.call(n,!1)};return(n,e)=>{const t=z,r=R,f=de,y=re,B=ie,F=j,h=L,V=X("permission");return x(),N(h,null,{default:l(()=>[a(Ve,{onSearch:I}),a(F,{"body-style":{paddingTop:"8px"}},{default:l(()=>[a(B,{sticky:"",ref_key:"tableRef",ref:u,"row-key":"deptId",columns:p.value,datasource:o,"show-overflow-tooltip":!0,"highlight-current-row":"","export-config":{fileName:"部门数据"},"default-expand-all":!0,pagination:!1,"cache-key":"systemDeptTable"},{toolbar:l(()=>[C((x(),N(t,{type:"primary",class:"ele-btn-icon",icon:d(Y),onClick:e[0]||(e[0]=s=>_())},{default:l(()=>e[2]||(e[2]=[m(" 新建 ")])),_:1},8,["icon"])),[[V,"system:dept:add"]]),a(t,{class:"ele-btn-icon",icon:d(Z),onClick:E},{default:l(()=>e[3]||(e[3]=[m(" 展开全部 ")])),_:1},8,["icon"]),a(t,{class:"ele-btn-icon",icon:d(ee),onClick:$},{default:l(()=>e[4]||(e[4]=[m(" 折叠全部 ")])),_:1},8,["icon"])]),status:l(({row:s})=>[a(r,{"model-value":s.status,type:"tag",code:"sys_normal_disable"},null,8,["model-value"])]),action:l(({row:s})=>[te("div",Ie,[C((x(),N(f,{type:"primary",underline:!1,onClick:M=>_(null,s.deptId)},{default:l(()=>e[5]||(e[5]=[m(" 添加 ")])),_:2},1032,["onClick"])),[[V,"system:dept:add"]]),C(a(y,{direction:"vertical",style:{margin:"0 8px"}},null,512),[[V,"system:dept:add"]]),C((x(),N(f,{type:"primary",underline:!1,onClick:M=>_(s)},{default:l(()=>e[6]||(e[6]=[m(" 修改 ")])),_:2},1032,["onClick"])),[[V,"system:dept:edit"]]),s.parentId!=0?(x(),ae(le,{key:0},[C(a(y,{direction:"vertical",style:{margin:"0 8px"}},null,512),[[V,"system:dept:edit"]]),C((x(),N(f,{type:"danger",underline:!1,onClick:M=>k(s)},{default:l(()=>e[7]||(e[7]=[m(" 删除 ")])),_:2},1032,["onClick"])),[[V,"system:dept:remove"]])],64)):oe("",!0)])]),_:1},8,["columns"])]),_:1}),a(xe,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=s=>i.value=s),data:b.value,"parent-id":c.value,"organization-data":v.value,onDone:I},null,8,["modelValue","data","parent-id","organization-data"])]),_:1})}}});export{Re as default};
