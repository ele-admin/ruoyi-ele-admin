import{_ as Q}from"./index-AmtRfZLy.js";import{aU as P,o as C,b as $,w as o,d as t,av as X,aw as S,s as c,e as T,ay as q,az as L,aV as h,E as R,aB as W,an as I,a$ as O,aW as Y,W as g,aq as Z,ad as D,aI as K,ah as ee,b7 as te,b8 as oe,b9 as j,bd as ne,a4 as le,ae,a8 as se,af as ie}from"./index-B6yCc2m_.js";import{_ as z}from"./index-BJMucfID.js";import{a as re}from"./index-C6QIYa0w.js";import{E as A,a as G}from"./index-6AfRRrL-.js";import{_ as de}from"./index-BH2AjK2H.js";const ce={__name:"notice-search",emits:["search"],setup(m,{emit:l}){const U=l,[p,k]=P({noticeTitle:"",createBy:"",noticeType:void 0}),v=()=>{U("search",{...p})},B=()=>{k(),v()};return(b,a)=>{const y=q,r=L,V=A,s=h,e=R,i=G,f=W,x=z;return C(),$(x,{"body-style":{paddingBottom:"2px"}},{default:o(()=>[t(f,{"label-width":"72px",onKeyup:X(v,["enter"]),onSubmit:a[3]||(a[3]=S(()=>{},["prevent"]))},{default:o(()=>[t(i,{gutter:8},{default:o(()=>[t(V,{lg:6,md:12,sm:12,xs:24},{default:o(()=>[t(r,{label:"公告标题"},{default:o(()=>[t(y,{clearable:"",modelValue:c(p).noticeTitle,"onUpdate:modelValue":a[0]||(a[0]=d=>c(p).noticeTitle=d),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),t(V,{lg:6,md:12,sm:12,xs:24},{default:o(()=>[t(r,{label:"创建者"},{default:o(()=>[t(y,{clearable:"",modelValue:c(p).createBy,"onUpdate:modelValue":a[1]||(a[1]=d=>c(p).createBy=d),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),t(V,{lg:6,md:12,sm:12,xs:24},{default:o(()=>[t(r,{label:"公告类型"},{default:o(()=>[t(s,{code:"sys_notice_type",modelValue:c(p).noticeType,"onUpdate:modelValue":a[2]||(a[2]=d=>c(p).noticeType=d),placeholder:"请选择"},null,8,["modelValue"])]),_:1})]),_:1}),t(V,{lg:6,md:12,sm:12,xs:24},{default:o(()=>[t(r,{"label-width":"16px"},{default:o(()=>[t(e,{type:"primary",onClick:v},{default:o(()=>a[4]||(a[4]=[T("查询")])),_:1}),t(e,{onClick:B},{default:o(()=>a[5]||(a[5]=[T("重置")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}};async function ue(m){const l=await I.get("/system/notice/list",{params:m});return l.data.code===200?l.data:Promise.reject(new Error(l.data.msg))}async function me(m){const l=await I.post("/system/notice",m);return l.data.code===200?l.data.msg:Promise.reject(new Error(l.data.msg))}async function pe(m){const l=await I.put("/system/notice",m);return l.data.code===200?l.data.msg:Promise.reject(new Error(l.data.msg))}async function _e(m){const l=await I.delete("/system/notice/"+m.join());return l.data.code===200?l.data.msg:Promise.reject(new Error(l.data.msg))}const fe={__name:"notice-edit",props:O({data:Object},{modelValue:{type:Boolean},modelModifiers:{}}),emits:O(["done"],["update:modelValue"]),setup(m,{emit:l}){const U=m,p=l,k=Y(m,"modelValue"),v=g(null),B=g({height:380}),b=g(!1),a=g(!1),y=g(null),[r,V,s]=P({noticeId:void 0,noticeTitle:"",noticeType:void 0,status:"0",noticeContent:""}),e=Z({noticeTitle:[{required:!0,message:"请输入公告标题",type:"string",trigger:"blur"}],noticeType:[{required:!0,message:"请选择公告类型",type:"string",trigger:"change"}]}),i=()=>{k.value=!1},f=()=>{var d,n;(n=(d=y.value)==null?void 0:d.validate)==null||n.call(d,N=>{if(!N)return;a.value=!0,(b.value?pe:me)(r).then(_=>{a.value=!1,D.success(_),i(),p("done")}).catch(_=>{a.value=!1,D.error(_.message)})})},x=()=>{U.data?(s(U.data),b.value=!0):(V(),b.value=!1),K(()=>{K(()=>{var d,n;(n=(d=y.value)==null?void 0:d.clearValidate)==null||n.call(d)})})};return(d,n)=>{const N=q,E=L,_=h,u=A,M=G,H=W,F=R,J=ee;return C(),$(J,{form:"",width:860,top:"40px",modelValue:k.value,"onUpdate:modelValue":n[5]||(n[5]=w=>k.value=w),title:b.value?"修改公告":"添加公告",onOpen:x},{footer:o(()=>[t(F,{onClick:i},{default:o(()=>n[6]||(n[6]=[T("取消")])),_:1}),t(F,{type:"primary",loading:a.value,onClick:f},{default:o(()=>n[7]||(n[7]=[T(" 保存 ")])),_:1},8,["loading"])]),default:o(()=>[t(H,{ref_key:"formRef",ref:y,model:c(r),rules:e,"label-width":"80px",onSubmit:n[4]||(n[4]=S(()=>{},["prevent"]))},{default:o(()=>[t(E,{label:"公告标题",prop:"noticeTitle"},{default:o(()=>[t(N,{clearable:"",modelValue:c(r).noticeTitle,"onUpdate:modelValue":n[0]||(n[0]=w=>c(r).noticeTitle=w),placeholder:"请输入公告标题"},null,8,["modelValue"])]),_:1}),t(M,{gutter:16},{default:o(()=>[t(u,{sm:12,xs:24},{default:o(()=>[t(E,{label:"公告类型",prop:"noticeType"},{default:o(()=>[t(_,{code:"sys_notice_type",modelValue:c(r).noticeType,"onUpdate:modelValue":n[1]||(n[1]=w=>c(r).noticeType=w),placeholder:"请选择公告类型"},null,8,["modelValue"])]),_:1})]),_:1}),t(u,{sm:12,xs:24},{default:o(()=>[t(E,{label:"状态",prop:"status"},{default:o(()=>[t(_,{code:"sys_notice_status",type:"radio",modelValue:c(r).status,"onUpdate:modelValue":n[2]||(n[2]=w=>c(r).status=w)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(E,{label:"内容"},{default:o(()=>[t(de,{ref_key:"editorRef",ref:v,init:B.value,modelValue:c(r).noticeContent,"onUpdate:modelValue":n[3]||(n[3]=w=>c(r).noticeContent=w)},null,8,["init","modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}},xe=Object.assign({name:"SystemNotice"},{__name:"index",setup(m){const[l,U]=te(["sys_notice_type","sys_notice_status"]),p=g(null),k=g([{type:"selection",columnKey:"selection",width:50,align:"center",fixed:"left"},{type:"index",columnKey:"index",width:50,align:"center",fixed:"left"},{prop:"noticeTitle",label:"公告标题",minWidth:160},{prop:"noticeType",label:"公告类型",width:90,align:"center",slot:"noticeType",formatter:s=>{var e;return(e=l.value.find(i=>i.dictValue==s.noticeType))==null?void 0:e.dictLabel}},{prop:"status",label:"状态",width:90,align:"center",slot:"status",formatter:s=>{var e;return(e=U.value.find(i=>i.dictValue==s.status))==null?void 0:e.dictLabel}},{prop:"createBy",label:"创建者",width:100,align:"center"},{prop:"createTime",label:"创建时间",width:180,align:"center"},{columnKey:"action",label:"操作",width:120,align:"center",slot:"action",hideInPrint:!0,hideInExport:!0}]),v=g([]),B=g(null),b=g(!1),a=({pages:s,where:e,orders:i})=>ue({...e,...i,...s}),y=s=>{var e,i;(i=(e=p.value)==null?void 0:e.reload)==null||i.call(e,{page:1,where:s})},r=s=>{B.value=s!=null?s:null,b.value=!0},V=s=>{const e=s==null?v.value:[s];if(!e.length){D.error("请至少选择一条数据");return}const i=e.map(f=>f.noticeId);ae.confirm(`是否确认删除公告编号为"${i.join()}"的数据项?`,"系统提示",{type:"warning",draggable:!0}).then(()=>{const f=D.loading({message:"请求中..",plain:!0});_e(i).then(()=>{f.close(),D.success("删除成功"),y()}).catch(x=>{f.close(),D.error(x.message)})}).catch(()=>{})};return(s,e)=>{const i=R,f=h,x=se,d=ie,n=re,N=z,E=Q,_=oe("permission");return C(),$(E,null,{default:o(()=>[t(ce,{onSearch:y}),t(N,{"body-style":{paddingTop:"8px"}},{default:o(()=>[t(n,{ref_key:"tableRef",ref:p,"row-key":"noticeId",columns:k.value,datasource:a,"show-overflow-tooltip":!0,selections:v.value,"onUpdate:selections":e[2]||(e[2]=u=>v.value=u),"highlight-current-row":"","export-config":{fileName:"通知公告"},"cache-key":"systemNoticeTable"},{toolbar:o(()=>[j((C(),$(i,{type:"primary",class:"ele-btn-icon",icon:c(ne),onClick:e[0]||(e[0]=u=>r())},{default:o(()=>e[4]||(e[4]=[T(" 新建 ")])),_:1},8,["icon"])),[[_,"system:notice:add"]]),j((C(),$(i,{type:"danger",class:"ele-btn-icon",icon:c(le),onClick:e[1]||(e[1]=u=>V())},{default:o(()=>e[5]||(e[5]=[T(" 删除 ")])),_:1},8,["icon"])),[[_,"system:notice:remove"]])]),status:o(({row:u})=>[t(f,{code:"sys_notice_status",type:"tag","model-value":u.status},null,8,["model-value"])]),noticeType:o(({row:u})=>[t(f,{code:"sys_notice_type",type:"tag","model-value":u.noticeType},null,8,["model-value"])]),action:o(({row:u})=>[j((C(),$(x,{type:"primary",underline:!1,onClick:M=>r(u)},{default:o(()=>e[6]||(e[6]=[T(" 修改 ")])),_:2},1032,["onClick"])),[[_,"system:notice:edit"]]),j(t(d,{direction:"vertical"},null,512),[[_,["system:notice:edit","system:notice:remove"]]]),j((C(),$(x,{type:"danger",underline:!1,onClick:M=>V(u)},{default:o(()=>e[7]||(e[7]=[T(" 删除 ")])),_:2},1032,["onClick"])),[[_,"system:notice:remove"]])]),_:1},8,["columns","selections"])]),_:1}),t(fe,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=u=>b.value=u),data:B.value,onDone:y},null,8,["modelValue","data"])]),_:1})}}});export{xe as default};
